<!DOCTYPE html>
<html>
  <head>
    <script type="text/javascript" src="https://d3js.org/d3.v5.min.js"></script>
    <script type="text/javascript" src='https://code.jquery.com/jquery-1.11.0.min.js'></script>
   <link rel="stylesheet" href="./Style.css">
    <script type="text/javascript" src="Scripts.js"></script>

    <link rel="shortcut icon" href="/Test_Data/d3.png" />
  </head>




  <body>
    <title>D3 Project</title>

    <div id="div" class="background"></div>
    <div id="div">
      <div class="sideMenu" style="display:flexbox">
        <div class="input">
            <input id="code"class="input-field" name="airportCode" type="text" autocomplete="off" required >
              
            <label for="airportCode" class="field-label">
              <span class="field-content">Airport Code</span>
            </label>

            <input class="input-field" name="airportCountry" type="text" autocomplete="off" required >
              
            <label for="airportCountry" class="field-label">
              <span class="field-content">Airport Country</span>
            </label>

            <button onclick="update()">Submit</button>  

          </div>
      </div>
      <div class="ListContainer">
      </div>
    </div>

  <script>

// ---------------------------------------------- JS Starts Here -------------------------------------
    //Establish global variables
    var  width = 960,
      height = 500;


    var airport_location = [],
    airports = new Map(),
    svg = d3.select(".ListContainer"),
    menuContiner = d3.select(".sideMenu"),
    windowDiv = document.getElementById("div"),
    count = 0;
    
    let baseHeight = 0;
    let fill = [];  
    let currentAirport;

    async function update() {
      currentAirport = document.getElementById("code").value
      fill = await FindAllRelatedAirports(currentAirport);
      fill.sort();
      makeParagraph() 
    }

    function makeParagraph() {

      svg.style("overflow", "scroll")
      d3.select(".ListContainer").selectAll("svg").remove();

      let graphHeight = height*(5/6);
      let graphWidth = width/4

      let y = d3.scaleLinear().domain([0,24]).range([0,graphHeight]);
      let x = d3.scaleLinear().domain([0,1]).range([0,graphWidth/4])

      let containers = d3.select(".ListContainer").selectAll("svg").data(fill).enter().append("svg")
      .style("position", "relative")
      .style("background", "#91A3B0")
      .style("opacity", "0.8")
      .attr("width", "300px")
      .attr("height", "500px")
      .style("margin", "5px");
      containers.append("text").text(d => {if (d != "  ") {return "Terminal " + d} else {return "Airport"}})
      .style("font-family", "serif")
      .style("font-size", "20px")
      .style("fill", "white")
      .style("text-shadow", "-1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000")
      .attr("x", "50%")
      .attr("y", "10%")
      .style("dominant-baseline", "middle")
      .style("text-anchor", "middle");
      console.log(containers);

      graphWidth = containers.node().getBoundingClientRect().width-50;
      x.range([0,graphWidth]);

      let charts = containers.append("svg").style("background", "white");
      charts.append("g").style("transform", "translate(10%,14.7%)").call(d3.axisLeft(y));
      charts.append("g").style("transform", "translate(10%,98%)").call(d3.axisBottom(x).tickFormat(""))
      

    }

    function sectionTitle(data) {
      let title = new String;
      console.log(data);
    }


    function incrementHeight() {
      baseHeight += 70;
      return baseHeight;
    }
    /*function resize() {
        width = windowDiv.clientWidth;
        height = windowDiv.clientHeight;

        menuContiner.style("width", width/5 + 'px').style("height", height *0.95+ 'px');
        d3.select("input").style("width", (width/5) -(height *0.05) + "px");
    }*/

  </script>
  </body>
</html>